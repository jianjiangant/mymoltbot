<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¾…åŠäº‹é¡¹ - MyMoltBot</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <link rel="stylesheet" href="../src/styles/todo.css">
</head>
<body>
  <div id="app">
    <div class="container">
      <div class="header">
        <h1>ğŸ“ å¾…åŠäº‹é¡¹æ¸…å•</h1>
        <p>è®°å½•ä½ çš„æ¯æ—¥ä»»åŠ¡ï¼Œæé«˜å·¥ä½œæ•ˆç‡</p>
        <a href="../index.html" class="back-link">â† è¿”å›ä¸»é¡µ</a>
      </div>
      
      <div class="input-section">
        <div class="input-group">
          <input 
            type="text" 
            v-model="newTodo" 
            placeholder="è¯·è¾“å…¥æ–°çš„å¾…åŠäº‹é¡¹..." 
            @keyup.enter="addTodo"
            class="todo-input"
          />
          <button @click="addTodo" class="add-btn">æ·»åŠ ä»»åŠ¡</button>
        </div>
      </div>
      
      <div class="filters">
        <button 
          v-for="filter in filters" 
          :key="filter.key"
          @click="setFilter(filter.key)"
          :class="['filter-btn', { active: currentFilter === filter.key }]"
        >
          {{ filter.label }}
        </button>
      </div>
      
      <div class="todo-list">
        <div v-if="filteredTodos.length === 0" class="empty-state">
          <div>ğŸ“‹</div>
          <p>{{ emptyStateMessage }}</p>
        </div>
        <div 
          v-for="todo in filteredTodos" 
          :key="todo.id" 
          :class="['todo-item', { completed: todo.completed }]"
        >
          <input 
            type="checkbox" 
            v-model="todo.completed" 
            @change="updateTodo(todo)" 
            class="todo-checkbox"
          />
          <div class="todo-text">{{ todo.text }}</div>
          <button @click="deleteTodo(todo.id)" class="delete-btn">Ã—</button>
        </div>
      </div>
      
      <div class="stats">
        <span>æ€»è®¡: {{ todos.length }} é¡¹</span>
        <span>å·²å®Œæˆ: {{ completedCount }} é¡¹</span>
      </div>
    </div>
  </div>

  <script>
    const { createApp, ref, computed, onMounted } = Vue;
    
    createApp({
      setup() {
        const newTodo = ref('');
        const todos = ref(JSON.parse(localStorage.getItem('todos')) || []);
        const currentFilter = ref('all');
        const filters = [
          { key: 'all', label: 'å…¨éƒ¨' },
          { key: 'active', label: 'å¾…å®Œæˆ' },
          { key: 'completed', label: 'å·²å®Œæˆ' }
        ];

        // æ ¹æ®å½“å‰è¿‡æ»¤æ¡ä»¶ç­›é€‰å¾…åŠäº‹é¡¹
        const filteredTodos = computed(() => {
          switch(currentFilter.value) {
            case 'active':
              return todos.value.filter(todo => !todo.completed);
            case 'completed':
              return todos.value.filter(todo => todo.completed);
            default:
              return [...todos.value];
          }
        });

        // è®¡ç®—å·²å®Œæˆçš„æ•°é‡
        const completedCount = computed(() => {
          return todos.value.filter(todo => todo.completed).length;
        });

        // ç©ºçŠ¶æ€æç¤ºä¿¡æ¯
        const emptyStateMessage = computed(() => {
          switch(currentFilter.value) {
            case 'active':
              return 'æš‚æ— å¾…å®Œæˆäº‹é¡¹ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„ä»»åŠ¡å¼€å§‹å§ï¼';
            case 'completed':
              return 'æš‚æ— å·²å®Œæˆäº‹é¡¹ï¼Œç»§ç»­åŠªåŠ›ï¼';
            default:
              return 'æš‚æ— å¾…åŠäº‹é¡¹ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„ä»»åŠ¡å¼€å§‹å§ï¼';
          }
        });

        // æ·»åŠ å¾…åŠäº‹é¡¹
        const addTodo = () => {
          const text = newTodo.value.trim();
          if (text === '') {
            alert('è¯·è¾“å…¥å¾…åŠäº‹é¡¹å†…å®¹ï¼');
            return;
          }
          
          const newTodoItem = {
            id: Date.now(),
            text: text,
            completed: false,
            createdAt: new Date().toISOString()
          };
          
          todos.value.push(newTodoItem);
          saveToLocalStorage();
          
          // æ¸…ç©ºè¾“å…¥æ¡†
          newTodo.value = '';
        };

        // æ›´æ–°å¾…åŠäº‹é¡¹çŠ¶æ€
        const updateTodo = (todo) => {
          saveToLocalStorage();
        };

        // åˆ é™¤å¾…åŠäº‹é¡¹
        const deleteTodo = (id) => {
          todos.value = todos.value.filter(todo => todo.id !== id);
          saveToLocalStorage();
        };

        // è®¾ç½®è¿‡æ»¤å™¨
        const setFilter = (filter) => {
          currentFilter.value = filter;
        };

        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        const saveToLocalStorage = () => {
          localStorage.setItem('todos', JSON.stringify(todos.value));
        };

        // é¡µé¢åŠ è½½æ—¶æ¢å¤æ•°æ®
        onMounted(() => {
          // æ•°æ®å·²ä»localStorageæ¢å¤åˆ°todoså“åº”å¼å˜é‡
        });

        return {
          newTodo,
          todos,
          filteredTodos,
          currentFilter,
          filters,
          completedCount,
          emptyStateMessage,
          addTodo,
          updateTodo,
          deleteTodo,
          setFilter
        };
      }
    }).mount('#app');
  </script>
</body>
</html>